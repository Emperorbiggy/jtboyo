import{r as a,a as r,V as l,j as e,H as k,O as A}from"./app-DETpqs1_.js";import{D as C,F as S,a as _,b as E}from"./DashboardLayout-BTxo8P8n.js";function I(){const[c,o]=a.useState([]),[p,i]=a.useState(!1),[t,n]=a.useState({app_name:"",whitelisted_ips:"",description:""}),[u,x]=a.useState(!1),[g,b]=a.useState(null),[f,j]=a.useState({});a.useEffect(()=>{h()},[]);const h=async()=>{try{const s=await r.get("/api/v1/auth-apps");o(s.data.data)}catch{l.error("Failed to fetch apps")}},m=s=>{n(d=>({...d,[s.target.name]:s.target.value}))},w=async()=>{try{u&&g?(await r.put(`/api/v1/auth-apps/${g}`,t),l.success("App updated")):(await r.post("/api/v1/generate-token",t),l.success("App created")),n({app_name:"",whitelisted_ips:"",description:""}),b(null),x(!1),i(!1),h()}catch{l.error("Submission failed")}},v=s=>{n({app_name:s.app_name,whitelisted_ips:s.whitelisted_ips.join(","),description:s.description||""}),x(!0),b(s.id),i(!0)},N=async s=>{try{await r.put(`/api/v1/auth-apps/${s.id}/toggle-status`),l.success("Status updated"),h()}catch{l.error("Status update failed")}},y=s=>{navigator.clipboard.writeText(s),l.success("Token copied")};return e.jsxs(C,{children:[e.jsx(k,{title:"Auth Apps"}),e.jsx(A,{}),e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-2xl font-semibold",children:"Auth Apps"}),e.jsxs("button",{className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",onClick:()=>{i(!0),x(!1),n({app_name:"",whitelisted_ips:"",description:""})},children:[e.jsx(S,{className:"inline-block mr-2"}),"Add App"]})]}),e.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-4",children:c.map(s=>e.jsxs("div",{className:"border rounded-lg shadow p-4 relative",children:[e.jsx("div",{className:"absolute top-2 right-2",children:e.jsx(D,{onEdit:()=>v(s),onToggle:()=>N(s),isActive:s.status})}),e.jsx("h2",{className:"text-lg font-bold",children:s.app_name}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:s.description}),e.jsxs("div",{className:"mt-2",children:[e.jsx("label",{className:"text-sm text-gray-500",children:"Token:"}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx("span",{className:"text-sm bg-gray-100 px-2 py-1 rounded break-all",children:f[s.id]?s.token:"••••••••••••••••••"}),e.jsx("button",{onClick:()=>j(d=>({...d,[s.id]:!d[s.id]})),className:"text-xs underline text-blue-600",children:f[s.id]?"Hide":"Show"}),e.jsx(_,{className:"cursor-pointer text-gray-600",onClick:()=>y(s.token)})]})]}),e.jsx("div",{className:"mt-2",children:e.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${s.status?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:s.status?"Active":"Inactive"})})]},s.id))}),p&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-30 flex justify-center items-center z-50",children:e.jsxs("div",{className:"bg-white p-6 rounded shadow-md w-full max-w-md",children:[e.jsx("h2",{className:"text-lg font-bold mb-4",children:u?"Edit App":"Create App"}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("input",{type:"text",name:"app_name",value:t.app_name,onChange:m,className:"w-full border rounded p-2",placeholder:"App Name"}),e.jsx("input",{type:"text",name:"whitelisted_ips",value:t.whitelisted_ips,onChange:m,className:"w-full border rounded p-2",placeholder:"Whitelisted IPs (comma-separated)"}),e.jsx("textarea",{name:"description",value:t.description,onChange:m,className:"w-full border rounded p-2",placeholder:"Description"}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("button",{onClick:()=>i(!1),className:"bg-gray-300 text-gray-800 px-4 py-2 rounded",children:"Cancel"}),e.jsx("button",{onClick:w,className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:u?"Update":"Save"})]})]})]})})]})}const D=({onEdit:c,onToggle:o,isActive:p})=>{const[i,t]=a.useState(!1);return e.jsxs("div",{className:"relative",children:[e.jsx(E,{onClick:()=>t(!i),className:"cursor-pointer text-gray-600"}),i&&e.jsxs("div",{className:"absolute right-0 mt-2 w-32 bg-white border shadow rounded z-10",children:[e.jsx("button",{onClick:()=>{t(!1),c()},className:"block w-full text-left px-4 py-2 hover:bg-gray-100",children:"Edit"}),e.jsx("button",{onClick:()=>{t(!1),o()},className:"block w-full text-left px-4 py-2 hover:bg-gray-100",children:p?"Deactivate":"Activate"})]})]})};export{I as default};
