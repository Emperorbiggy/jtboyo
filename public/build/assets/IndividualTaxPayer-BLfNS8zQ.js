import{r,j as e,H as k,L as P}from"./app-Dotmn3Oo.js";import{D as F,d as L}from"./DashboardLayout-BtgcaJMp.js";import{D as f,u as m,w as A,F as I}from"./FileSaver.min-OS9GKoWQ.js";import"./index-DY3t9lRD.js";const E="/app/public";function G(){const[l,y]=r.useState(1),[n,g]=r.useState(""),[d,w]=r.useState(""),[v,S]=r.useState([]),[c,D]=r.useState(()=>{const t=new Date;return t.setDate(t.getDate()-6),t}),[o,T]=r.useState(new Date),i=10;r.useEffect(()=>{(async()=>{try{const a=await fetch("api/jtb/individuals",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({fromDate:c,toDate:o})});console.log("Response status:",a.status);const s=await a.json();console.log("Response data:",s),s.success&&s.taxpayers&&S(s.taxpayers)}catch(a){console.error("Failed to fetch taxpayers:",a)}})()},[c,o]);const p=v.filter(t=>{var j,b,N;const a=((j=t.tin)==null?void 0:j.toLowerCase().includes(n.toLowerCase()))||((b=t.SBIRt_name)==null?void 0:b.toLowerCase().includes(n.toLowerCase()))||((N=t.last_name)==null?void 0:N.toLowerCase().includes(n.toLowerCase())),s=d===""||t.TaxpayerStatus===d,x=new Date(t.date_of_birth),C=x>=c&&x<=o;return a&&s&&C}),h=Math.ceil(p.length/i),u=p.slice((l-1)*i,l*i),_=()=>{const t=m.json_to_sheet(p),a=m.book_new();m.book_append_sheet(a,t,"Taxpayers");const s=A(a,{bookType:"xlsx",type:"array"}),x=new Blob([s],{type:"application/octet-stream"});I.saveAs(x,"individual_taxpayers.xlsx")};return e.jsxs(F,{children:[e.jsx(k,{title:"Individual Taxpayers"}),e.jsxs("div",{className:"px-4 sm:px-6 lg:px-8 py-8",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center gap-4 mb-6",children:[e.jsx(P,{href:`${E}/dashboard`,className:"bg-green-700 text-white px-4 py-2 rounded hover:bg-green-800",children:"← Back to Dashboard"}),e.jsxs("div",{className:"flex flex-wrap gap-4 items-center",children:[e.jsxs("div",{className:"flex items-center border px-2 py-1 rounded",children:[e.jsx(L,{className:"text-gray-500 mr-2"}),e.jsx("input",{type:"text",value:n,onChange:t=>g(t.target.value),placeholder:"Search by TIN or Name",className:"px-2 py-1 outline-none"})]}),e.jsxs("select",{value:d,onChange:t=>w(t.target.value),className:"border px-3 py-2 rounded text-sm",children:[e.jsx("option",{value:"",children:"All Status"}),e.jsx("option",{value:"Active",children:"Active"}),e.jsx("option",{value:"Inactive",children:"Inactive"})]}),e.jsx(f,{selected:c,onChange:D,dateFormat:"dd-MM-yyyy",className:"border px-3 py-2 rounded text-sm",placeholderText:"From Date"}),e.jsx(f,{selected:o,onChange:T,dateFormat:"dd-MM-yyyy",className:"border px-3 py-2 rounded text-sm",placeholderText:"To Date"}),e.jsx("button",{onClick:_,className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Export to Excel"})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full bg-white rounded shadow border text-sm",children:[e.jsx("thead",{className:"bg-green-700 text-white",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-2 text-left",children:"TIN"}),e.jsx("th",{className:"px-4 py-2 text-left",children:"Full Name"}),e.jsx("th",{className:"px-4 py-2 text-left",children:"Gender"}),e.jsx("th",{className:"px-4 py-2 text-left",children:"DOB"}),e.jsx("th",{className:"px-4 py-2 text-left",children:"Phone"}),e.jsx("th",{className:"px-4 py-2 text-left",children:"Nationality"}),e.jsx("th",{className:"px-4 py-2 text-left",children:"State"}),e.jsx("th",{className:"px-4 py-2 text-left",children:"LGA"}),e.jsx("th",{className:"px-4 py-2 text-left",children:"Tax Authority"}),e.jsx("th",{className:"px-4 py-2 text-left",children:"Status"})]})}),e.jsx("tbody",{children:u.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"10",className:"text-center py-4 text-gray-500",children:"No taxpayers found."})}):u.map((t,a)=>e.jsxs("tr",{className:"hover:bg-gray-100 border-b",children:[e.jsx("td",{className:"px-4 py-2",children:t.tin}),e.jsx("td",{className:"px-4 py-2",children:`${t.Title||""} ${t.SBIRt_name||""} ${t.middle_name||""} ${t.last_name||""}`}),e.jsx("td",{className:"px-4 py-2",children:t.GenderName}),e.jsx("td",{className:"px-4 py-2",children:t.date_of_birth}),e.jsx("td",{className:"px-4 py-2",children:t.phone_no_1}),e.jsx("td",{className:"px-4 py-2",children:t.nationality_name}),e.jsx("td",{className:"px-4 py-2",children:t.StateName}),e.jsx("td",{className:"px-4 py-2",children:t.LGAName}),e.jsx("td",{className:"px-4 py-2",children:t.TaxAuthorityName}),e.jsx("td",{className:"px-4 py-2",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-bold ${t.TaxpayerStatus==="Active"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:t.TaxpayerStatus})})]},a))})]})}),e.jsxs("div",{className:"flex justify-between items-center mt-4 text-sm",children:[e.jsx("button",{onClick:()=>y(t=>Math.max(t-1,1)),disabled:l===1,className:"bg-green-600 text-white px-4 py-2 rounded disabled:bg-gray-300",children:"Previous"}),e.jsxs("span",{className:"text-gray-700",children:["Page ",l," of ",h]}),e.jsx("button",{onClick:()=>y(t=>Math.min(t+1,h)),disabled:l===h,className:"bg-green-600 text-white px-4 py-2 rounded disabled:bg-gray-300",children:"Next"})]})]})]})}export{G as default};
